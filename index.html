<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Value Investor's Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"></noscript>
</head>
<body class="p-4 md:p-8">
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <button id="closeModalBtn" class="text-gray-400 hover:text-white absolute top-4 right-4 text-2xl font-bold">&times;</button>
            <h2 class="text-2xl font-semibold text-white mb-4 text-center">Access AI Features</h2>
            <p class="text-center text-gray-400 mb-6">Please log in to use the AI-powered analysis and forecasting.</p>
            <form id="loginForm" class="space-y-4">
                <input type="email" id="emailInput" class="input-field w-full p-2 rounded" placeholder="Email" required>
                <input type="password" id="passwordInput" class="input-field w-full p-2 rounded" placeholder="Password" required>
                <button type="submit" class="btn-primary w-full p-2 rounded font-semibold">Login</button>
            </form>
            <p id="loginError" class="text-red-500 text-sm mt-4 text-center h-4"></p>
        </div>
    </div>

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-white">Value Investor's Dashboard</h1>
            <p class="mt-2 text-lg text-gray-400">Automating the "Lao Tang" Valuation Method</p>
            <div id="authStatus" class="text-sm text-gray-500 mt-2">
                Status: <span id="userStatus" class="font-semibold text-gray-400">Public</span>
                <button id="loginBtn" class="ml-4 text-blue-400 hover:underline">Login to Access AI & Watchlist</button>
                <button id="logoutBtn" class="ml-4 text-red-400 hover:underline hidden">Logout</button>
            </div>
        </header>

        <section class="mb-10">
            <h2 class="text-2xl font-semibold text-white mb-4 border-b-2 border-gray-700 pb-2">The Methodology: "Don't Look at the Fool, Look at the Land"</h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="card p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-blue-400 mb-2">Ideal Buy Point</h3>
                    <p class="mb-4">The goal is to buy a great business at a fair price, creating a significant margin of safety. We buy at **50% of the company's reasonable valuation three years from now.**</p>
                    <div class="text-sm p-4 bg-gray-800 rounded">
                        <p class="font-mono break-words"><span class="font-bold text-green-400">Ideal Buy Price</span> = (Net Profit in 3 Yrs × Reasonable P/E) × 0.5</p>
                    </div>
                    <p class="text-xs mt-2 text-gray-400">A "Reasonable P/E" (default: 25) implies an earnings yield comparable to long-term risk-free rates.</p>
                </div>
                <div class="card p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-blue-400 mb-2">Obvious Sell Point</h3>
                    <p class="mb-4">Selling prevents greed from taking over when the market is euphoric. We sell when the business is **obviously overvalued**, defined as the minimum of two calculations to ensure conservative exit timing.</p>
                    <div class="text-sm p-4 bg-gray-800 rounded">
                        <p class="font-mono break-words mb-2"><span class="font-bold text-red-400">Option 1:</span> Current Year's Net Profit × Overvalued P/E</p>
                        <p class="font-mono break-words mb-2"><span class="font-bold text-red-400">Option 2:</span> 3-Year Future Net Profit × 1.5</p>
                        <p class="font-mono break-words"><span class="font-bold text-red-400">Obvious Sell Price</span> = Minimum of (Option 1, Option 2)</p>
                    </div>
                    <p class="text-xs mt-2 text-gray-400">This conservative approach ensures we exit before extreme overvaluation, using whichever metric suggests selling first.</p>
                </div>
            </div>
        </section>

        <main class="grid lg:grid-cols-3 gap-8">
            <div class="lg:col-span-1">
                <div class="card p-6 rounded-lg sticky top-8">
                    <h2 class="text-2xl font-semibold text-white mb-4">Valuation Calculator</h2>
                    <form id="stockForm" class="space-y-4">
                        <input type="hidden" id="stockId">
                        <div>
                            <label for="ticker" class="block text-sm font-medium">Ticker Symbol</label>
                            <input type="text" id="ticker" class="input-field w-full mt-1 p-2 rounded" placeholder="e.g., AAPL" required>
                        </div>
                        <div>
                            <label for="shares" class="block text-sm font-medium">Shares Outstanding (in Billions)</label>
                            <input type="number" step="0.01" id="shares" class="input-field w-full mt-1 p-2 rounded" placeholder="e.g., 15.5" required>
                        </div>
                        <div>
                            <label for="currentProfit" class="block text-sm font-medium">Current Year Est. Profit (in Billions)</label>
                             <div class="flex items-center space-x-2">
                                <input type="number" step="0.01" id="currentProfit" class="input-field w-full mt-1 p-2 rounded" placeholder="e.g., 101" required>
                            </div>
                        </div>
                        <div>
                            <label for="futureProfit" class="block text-sm font-medium">3-Yr Future Est. Profit (in Billions)</label>
                            <input type="number" step="0.01" id="futureProfit" class="input-field w-full mt-1 p-2 rounded" placeholder="e.g., 125" required>
                        </div>
                        <button type="button" id="suggestForecastBtn" class="btn-secondary w-full p-2 rounded font-semibold text-sm">✨ Suggest Forecast</button>
                        <div class="grid grid-cols-2 gap-4 pt-2">
                            <div>
                                <label for="reasonablePE" class="block text-sm font-medium">Reasonable P/E</label>
                                <input type="number" id="reasonablePE" class="input-field w-full mt-1 p-2 rounded" value="25">
                            </div>
                            <div>
                                <label for="overvaluedPE" class="block text-sm font-medium">Overvalued P/E</label>
                                <input type="number" id="overvaluedPE" class="input-field w-full mt-1 p-2 rounded" value="50">
                            </div>
                        </div>
                        <div class="flex space-x-2 pt-2">
                             <button type="submit" class="btn-primary w-full p-2 rounded font-semibold">Save to Watchlist</button>
                             <button type="button" id="calculateBtn" class="btn-secondary w-full p-2 rounded font-semibold">Calculate Only</button>
                        </div>
                         <button type="button" id="clearFormBtn" class="btn-secondary w-full p-2 rounded font-semibold mt-2">New Entry</button>
                    </form>
                </div>
            </div>
            
            <div class="lg:col-span-2 space-y-8">
                <div class="card p-6 rounded-lg">
                    <h2 class="text-2xl font-semibold text-white mb-4">Valuation Result</h2>
                    <div id="resultOutput" class="text-center text-gray-400">
                        <p>Enter stock data and click "Calculate" to see the results.</p>
                    </div>
                </div>
                
                <div class="card p-6 rounded-lg">
                    <div class="flex justify-between items-center mb-4">
                         <h2 class="text-2xl font-semibold text-white">✨ AI-Powered Analysis</h2>
                         <button id="analyzeBtn" class="btn-primary px-4 py-2 text-sm rounded font-semibold">Analyze Ticker</button>
                    </div>
                    <div id="aiAnalysisOutput" class="text-gray-300">
                        <p class="text-center text-gray-400">Log in to use the AI-powered business quality overview.</p>
                    </div>
                </div>

                <div class="card p-6 rounded-lg">
                    <h2 class="text-2xl font-semibold text-white mb-4">My Watchlist</h2>
                    <div id="loader" class="loader" style="display: none;"></div>
                    <div id="stockList" class="space-y-4">
                        <p class="text-center text-gray-400">Log in to view your watchlist.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>

